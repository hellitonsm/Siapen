<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41136,6423951852" ScriptLanguage="PascalScript" ScriptText.Text="  
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin                              &#13;&#10; Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');    &#13;&#10;  Sqldados.Open;&#13;&#10;  while not Sqldados.EOF do      &#13;&#10;  begin          &#13;&#10;       Combobox1.Items.Add(sqldados.FieldByName('nome_interno').AsString);&#13;&#10;       Sqldados.Next;                                                     &#13;&#10; end;&#13;&#10;  ComboBox1.itemindex := -1;&#13;&#10;  ComboBox1.setfocus;&#13;&#10;     &#13;&#10;end;   &#13;&#10;     &#13;&#10;&#13;&#10;   begin&#13;&#10;   end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C3100000020446174615365743D2273716C6461646F732220446174615365744E616D653D2253716C4C69737461496E7465726E6F2200010C2C00000020446174615365743D2273716C7669736974612220446174615365744E616D653D2273716C7669736974612200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C7570220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C16000000204E616D653D22474C4F42414C5F434F4E464552452200010C0B000000204E616D653D225247492200010C19000000204E616D653D2249445F5550222056616C75653D223130362200010C34000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D22274D494E495354C952494F204441204A55535449C741272200010C49000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227444550415254414D454E544F2050454E4954454E4349C152494F204E4143494F4E414C272200010C4B000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D222744495245544F52494120444F2053495354454D412050454E4954454E4349C152494F20444F20444627220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXQuery Name="sqldados" UserName="SqlListaInterno" CloseDataSource="True" FieldAliases.Text="NOME_INTERNO=NOME_INTERNO&#13;&#10;ID_INTERNO=ID_INTERNO" SQL.Text="SELECT    &#13;&#10;       i.nome_interno,  &#13;&#10;       i.rgi                   &#13;&#10; &#13;&#10;&#13;&#10;FROM interno i&#13;&#10;where i.id_up = :ID_UP&#13;&#10;and i.st = 'A'&#13;&#10;order by i.nome_interno                                                                 &#13;&#10;    &#13;&#10;    " Database="Database" PropData="05704C65667402440470546F7003A4000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXDatabase Name="Database" ConnectionName="Devart InterBase" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.dll" PropData="05704C65667403A8000470546F700264"/>
    <TfrxDBXQuery Name="sqlvisita" UserName="sqlvisita" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10; i.nome_interno,&#13;&#10; i.rgi,&#13;&#10; mv.data_visita,&#13;&#10; v.visitante,&#13;&#10; gp.grau_parentesco,&#13;&#10; mv.dinheiro&#13;&#10;&#13;&#10;from mov_diario_visitantes mv&#13;&#10;inner join visitante v on v.id_visitante = mv.id_visitante&#13;&#10;inner join interno i on i.id_interno = v.id_interno&#13;&#10;inner join grau_parentesco gp on gp.id_grau_parentesco = v.id_grau_parentesco&#13;&#10;where i.st = 'A'&#13;&#10;and mv.data_visita between :dt1 and :dt2&#13;&#10;and i.id_up = :ID_UP           &#13;&#10;and i.nome_interno = :NOMEINTERNO                                                                                  &#13;&#10;and mv.cancelado is null&#13;&#10;and mv.dinheiro &#60;&#62; '0'&#13;&#10;&#13;&#10;order by visitante                &#13;&#10;                                                              " Database="Database" PropData="05704C65667402440470546F7002640A506172616D657465727301010C37000000204E616D653D22647431222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224454312E646174652200010C37000000204E616D653D22647432222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224454322E646174652200010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C43000000204E616D653D224E4F4D45494E5445524E4F222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F626F78312E74657874220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP&#13;&#10;  " Database="Database" PropData="05704C65667403A8000470546F7003A4000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="293" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Height="158,74026" Left="0" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo10" Left="0" Top="6,55906" Width="718,1107" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="0" Top="67,03154" Width="718,1107" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="0" Top="132,28355" Width="714,33117" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="12" HAlign="haCenter" ParentFont="False" Text="CONSULTA - VALOR RECEBIDO POR INTERNO"/>
      <TfrxPictureView Name="Picture3" Left="593,38621976" Top="18,89765" Width="109,60629921" Height="105,82677165" FileLink="..\logo\direita.jpg"/>
      <TfrxPictureView Name="Picture4" Left="3,77953" Top="22,67717512" Width="109,60629921" Height="105,82677165" FileLink="..\logo\esquerda.jpg"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" Height="26,45671" Left="0" Top="600,94527" Width="718,1107">
      <TfrxMemoView Name="Memo19" Left="0" Top="7,55906" Width="680,3154" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxPageHeader Name="PageHeader1" Height="101,96073" Left="0" Top="200,31509" Width="718,1107">
      <TfrxMemoView Name="Memo1" Left="15,11812" Top="7,55906" Width="570,70903" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-24" Font.Name="Lucida Console" Font.Style="1" ParentFont="False" Text="INTERNO: [sqlvisita.&#34;NOME_INTERNO&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="0" Top="64,16543" Width="718,11033386" Height="15,11812" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-24" Font.Name="Lucida Console" Font.Style="0" Frame.Typ="4" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo4" Left="0" Top="83,14966" Width="381,73253" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="VISITANTE"/>
      <TfrxMemoView Name="Memo5" Left="495,11843" Top="83,14966" Width="117,16543" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="DATA DA VISITA"/>
      <TfrxMemoView Name="Memo9" Left="612,28386" Top="83,14966" Width="109,60637" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="VALOR"/>
      <TfrxMemoView Name="Memo11" Left="381,73253" Top="83,14966" Width="113,3859" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="PARENTESCO"/>
      <TfrxMemoView Name="Memo14" Left="15,11812" Top="34,01577" Width="328,81911" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-24" Font.Name="Lucida Console" Font.Style="1" ParentFont="False" Text="RGI: [sqlvisita.&#34;RGI&#34;]"/>
    </TfrxPageHeader>
    <TfrxMasterData Name="MasterData1" Height="71,81107" Left="0" Top="408,18924" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="sqlvisita" DataSetName="sqlvisita" RowCount="0" Stretched="True">
      <TfrxMemoView Name="sqladvogadoRGI" Left="0" Top="3,77953" Width="381,73253" Height="18,89765" StretchMode="smMaxHeight" DataSet="sqlvisita" DataSetName="sqlvisita" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sqlvisita.&#34;VISITANTE&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="495,11843" Top="3,77953" Width="117,16543" Height="18,89765" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[sqlvisita.&#34;DATA_VISITA&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="612,28386" Top="3,77953" Width="109,60637" Height="18,89765" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[sqlvisita.&#34;DINHEIRO&#34;]"/>
      <TfrxMemoView Name="Memo13" Left="381,73253" Top="3,77953" Width="113,3859" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[sqlvisita.&#34;grau_parentesco&#34;]"/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader1" Height="22,67718" Left="0" Top="362,83488" Width="718,1107" Condition="sqlvisita.&#34;NOME_INTERNO&#34;"/>
    <TfrxGroupFooter Name="GroupFooter1" Height="37,7953" Left="0" Top="502,67749" Width="718,1107">
      <TfrxMemoView Name="Memo2" Left="0" Top="15,11812" Width="495,11843" Height="18,89765" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="TOTAL RECEBIDO: [SUM(&#60;sqlvisita.&#34;DINHEIRO&#34;&#62;,MasterData1)]"/>
    </TfrxGroupFooter>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Informe Interno ou Prontuário" Height="286" Left="372" Top="130" Width="503" OnCloseQuery="DialogPage1OnCloseQuery" OnShow="DialogPage1OnShow">
    <TfrxLabelControl Name="Label1" Left="29" Top="13" Width="164" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Nome do Interno" Color="15854311" OnClick="Label1OnClick"/>
    <TfrxButtonControl Name="Button1" Left="36" Top="204" Width="75" Height="25" Caption="OK" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="260" Top="204" Width="75" Height="25" Caption="Cancelar" ModalResult="3"/>
    <TfrxComboBoxControl Name="ComboBox1" Left="29" Top="37" Width="425" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1"/>
    <TfrxDateEditControl Name="DT1" Left="36" Top="160" Width="145" Height="21" Color="-16777211" Date="41136,5863748611" Time="41136,5863748611"/>
    <TfrxDateEditControl Name="DT2" Left="212" Top="160" Width="145" Height="21" Color="-16777211" Date="41136,5864343981" Time="41136,5864343981"/>
    <TfrxLabelControl Name="Label2" Left="36" Top="140" Width="163" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Data da visita ou Período" Color="13948117"/>
    <TfrxEditControl Name="Edit1" Left="32" Top="92" Width="121" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxLabelControl Name="Label3" Left="32" Top="68" Width="101" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Prontuário" Color="15854311" OnClick="Label1OnClick"/>
  </TfrxDialogPage>
</TfrxReport>
