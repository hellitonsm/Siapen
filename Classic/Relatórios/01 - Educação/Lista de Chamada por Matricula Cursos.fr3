<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="44986,6228603125" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var i:integer;&#13;&#10;begin&#13;&#10;   if Memo11.Lines.Count&#62;0 then&#13;&#10;       begin&#13;&#10;               SqlExportar.Sql.Add(' and i.rgi in(');&#13;&#10;               for i:=0 to Memo11.Lines.Count-1 do&#13;&#10;               begin&#13;&#10;                       //parametro:=parametro+''''+memo40.Lines[i]+'''';&#13;&#10;                       SqlExportar.Sql.Add(''''+UpperCase(memo11.Lines[i])+'''');&#13;&#10;                       //if i&#60;Memo40.Lines.Count-1 then parametro:=parametro+',';&#13;&#10;                       if i&#60;Memo11.Lines.Count-1 then SqlExportar.Sql.Add(',');&#13;&#10;               end;&#13;&#10;       SqlExportar.SQL.Add(') order by g.galeria, so.solario, i.nome_interno');&#13;&#10;       end;&#13;&#10;   Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exename)+'..\config\dbxconnections.ini');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  { IF &#60;GLOBAL_CONFERE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end; }&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Database.Params.LoadFromFile('..\config\dbxconnections.ini');&#13;&#10;  SQLBloco.Open;&#13;&#10;  while not SQLBloco.EOF do&#13;&#10;  begin&#13;&#10;       ComboBox1.Items.Add(SQLBloco.FieldByName('galeria').AsString);&#13;&#10;       SQLBloco.Next;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C2600000020446174615365743D2253716C416C612220446174615365744E616D653D2253716C416C612200010C2A00000020446174615365743D2253716C426C6F636F2220446174615365744E616D653D2253716C426C6F636F2200010C3000000020446174615365743D2253716C4578706F727461722220446174615365744E616D653D2253716C4578706F727461722200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C7570220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C23000000204E616D653D22474C4F42414C5F4A55524944494341222056616C75653D222752272200010C19000000204E616D653D22474C4F42414C5F4449534349504C494E412200010C17000000204E616D653D22474C4F42414C5F454455434143414F2200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C65667403B4000470546F700240"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C65667402600470546F7002640A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlExportar" UserName="SqlExportar" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select i.NOME_INTERNO as nome, i.rgi,                &#13;&#10;i.DATA_MATRICULA as dataentrada,&#13;&#10;i.TURMA as turma, p.pavilhao, g.galeria, c.cela, so.solario                                                                                                             &#13;&#10;from interno i&#13;&#10;INNER JOIN PAVILHAO p ON (p.id_pavilhao = i.idpavilhao)&#13;&#10;INNER JOIN GALERIA g ON ( g.id_galeria = i.idgaleria)&#13;&#10;INNER JOIN SOLARIO so ON ( so.id_solario = i.idsolario)    &#13;&#10;INNER JOIN CELA c ON (c.id_cela = i.idcela)&#13;&#10;where i.st='A' and g.galeria like '%' || :galeria                                                                                          &#13;&#10;&#13;&#10;&#13;&#10;                       &#13;&#10;&#13;&#10;                                      &#13;&#10;      " Database="database" PropData="05704C65667402680470546F7003C8000A506172616D657465727301010C3F000000204E616D653D2267616C65726961222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F426F78312E74657874220000"/>
    <TfrxDBXQuery Name="SqlAla" UserName="SqlAla" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select s.solario from solario s&#13;&#10;inner join galeria g on (g.id_galeria = s.idgaleria)    &#13;&#10;inner join pavilhao p on (p.id_pavilhao=g.idpavilhao)                                                                                                                   &#13;&#10;where p.id_up = :id_up                                                             &#13;&#10;order by s.solario                         " Database="database" PropData="05704C65667403BC000470546F70039C000A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlBloco" UserName="SqlBloco" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select g.galeria from galeria g&#13;&#10;inner join pavilhao p on (p.id_pavilhao=g.idpavilhao)&#13;&#10;where p.id_up = :id_up&#13;&#10;order by g.galeria    " Database="database" PropData="05704C65667403A0000470546F700340010A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" Columns="1" ColumnWidth="190" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageFooter Name="PageFooter1" Height="26,45671" Left="0" Top="377,953" Width="1046,92981">
      <TfrxMemoView Name="Memo19" Left="0" Top="7,55906" Width="680,3154" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="15,14162" Left="0" ParentFont="False" Top="211,65368" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="SqlExportar" DataSetName="SqlExportar" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo5" Left="0" Top="0" Width="21,41733667" Height="15,11811024" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="13" ParentFont="False" Text="[line]"/>
      <TfrxMemoView Name="SqlChamadaNOME_INTERNO" Left="82,5906" Top="0" Width="179,87415" Height="15,11812" StretchMode="smMaxHeight" DataSetName="SqlChamada" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="13" ParentFont="False" Text="[SqlExportar.&#34;NOME&#34;]"/>
      <TfrxShapeView Name="Shape2" Left="301,92146" Top="0" Width="18,89765" Height="15,11812" Frame.Typ="15"/>
      <TfrxShapeView Name="Shape3" Left="320,81911" Top="0" Width="18,89765" Height="15,11812" Frame.Typ="15"/>
      <TfrxShapeView Name="Shape4" Left="377,51206" Top="0" Width="18,78740157" Height="15,11812" Frame.Typ="15"/>
      <TfrxMemoView Name="SqlChamadaRGI" Left="21,16535433" Top="0" Width="60,47248" Height="15,11812" StretchMode="smMaxHeight" DataSetName="SqlChamada" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="13" ParentFont="False" Text="[SqlExportar.&#34;rgi&#34;]"/>
      <TfrxShapeView Name="Shape5" Left="283" Top="0,0235" Width="18,89765" Height="15,11812" Frame.Typ="15"/>
      <TfrxMemoView Name="Memo12" Left="264,5671" Top="0" Width="756,2919" Height="15,11812" StretchMode="smMaxHeight" DataSetName="SqlChamada" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="14" ParentFont="False" Text=""/>
      <TfrxShapeView Name="Shape6" Left="359,05535" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape9" Left="396,85065" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape10" Left="340,1577" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape11" Left="472,44125" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape12" Left="491,3389" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape13" Left="510,23655" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape14" Left="529,1342" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape15" Left="548,03185" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape16" Left="585,82715" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape17" Left="604,7248" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape18" Left="623,62245" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape19" Left="642,5201" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape20" Left="415,7483" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape22" Left="264,5671" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape21" Left="434,64595" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape23" Left="453,5436" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape24" Left="566,9295" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxMemoView Name="Memo13" Left="264,5671" Top="0" Width="756,2919" Height="15,11812" StretchMode="smMaxHeight" DataSetName="SqlChamada" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="14" ParentFont="False" Text=""/>
      <TfrxShapeView Name="Shape26" Left="661,41775" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape25" Left="680,3154" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape27" Left="699,21305" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape28" Left="718,1107" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape29" Left="737,00835" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape30" Left="755,906" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape31" Left="774,80365" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape32" Left="793,7013" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape33" Left="812,59895" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape34" Left="831,4966" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape35" Left="850,39425" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape36" Left="869,2919" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape37" Left="888,18955" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape38" Left="907,0872" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape39" Left="925,98485" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape40" Left="944,8825" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape41" Left="963,78015" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape42" Left="982,6778" Top="0" Width="18,89765" Height="15,11812"/>
      <TfrxShapeView Name="Shape43" Left="1001,57545" Top="0" Width="18,89765" Height="15,11812"/>
    </TfrxMasterData>
    <TfrxReportSummary Name="ReportSummary1" Height="30,23624" Left="0" Top="325,03958" Width="1046,92981">
      <TfrxMemoView Name="Memo9" Left="12,55905512" Top="3,77953" Width="198,4250748" Height="18,89764024" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="12" ParentFont="False" Text="Total de Alunos: [COUNT(MasterData1)]"/>
    </TfrxReportSummary>
    <TfrxPageHeader Name="PageHeader1" Height="56,69295" Left="0" Top="18,89765" Width="1046,92981">
      <TfrxMemoView Name="Memo44" Left="1,67718" Top="36,7953" Width="1039,37075" Height="15,11812" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="7" HAlign="haCenter" ParentFont="False" Text="REFERÃŠNCIA:  [EDIT3.TEXT]"/>
      <TfrxMemoView Name="Memo3" Left="3,44094" Top="5,11812" Width="1037,82746" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="7" HAlign="haCenter" ParentFont="False" Text="Lista de Chamada dos Alunos"/>
    </TfrxPageHeader>
    <TfrxGroupHeader Name="GroupHeader1" Height="30,23624" Left="0" Top="158,74026" Width="1046,92981" AllowSplit="True" Condition="SqlExportar.&#34;Solario&#34;">
      <TfrxMemoView Name="Memo45" Left="0" Top="15,11812" Width="21,5433070866142" Height="15,11812" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="NÂº"/>
      <TfrxMemoView Name="Memo46" Left="21,1653543307087" Top="15,11811024" Width="60,47244094" Height="15,11812" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Pront."/>
      <TfrxMemoView Name="Memo48" Left="82,77165354" Top="15,11811024" Width="937,32326181" Height="15,11811024" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text=" Nome"/>
      <TfrxMemoView Name="Memo6" Left="0" Top="0" Width="1019,92174071" Height="15,11811024" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[SqlExportar.&#34;Galeria&#34;] - [SqlExportar.&#34;solario&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter1" Height="15,11812" Left="0" Top="249,44898" Width="1046,92981" AllowSplit="True"/>
    <TfrxGroupHeader Name="GroupHeader2" Height="0" Left="0" Top="136,06308" Width="1046,92981" Condition="SqlExportar.&#34;Galeria&#34;"/>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="400" Left="264" Top="150" Width="450" OnShow="DialogPage1OnShow">
    <TfrxMemoControl Name="Memo11" Left="12" Top="68" Width="401" Height="177" Color="-16777211" Lines.Text="" MaxLength="0"/>
    <TfrxButtonControl Name="Button1" Left="68" Top="328" Width="75" Height="25" Caption="OK" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="268" Top="328" Width="75" Height="25" Caption="Cancelar" ModalResult="2"/>
    <TfrxLabelControl Name="Label1" Left="12" Top="8" Width="52" Height="13" Caption="Referência" Color="-16777201"/>
    <TfrxEditControl Name="Edit3" Left="12" Top="32" Width="401" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxComboBoxControl Name="ComboBox1" Left="12" Top="276" Width="397" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1"/>
    <TfrxLabelControl Name="ALA" Left="12" Top="256" Width="19" Height="13" Caption="ALA" Color="-16777201"/>
  </TfrxDialogPage>
</TfrxReport>
