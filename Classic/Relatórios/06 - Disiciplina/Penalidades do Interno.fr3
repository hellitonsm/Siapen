<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41183,5910905903" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');    &#13;&#10;  SqlListaInterno.Open;&#13;&#10;  while not SqlListaInterno.EOF do&#13;&#10;  begin&#13;&#10;    ComboBox1.Items.Add(SqlListaInterno.FieldByName('NOME_INTERNO').AsString&#13;&#10;    +' ('+SqlListaInterno.FieldByName('RGI').AsString+')' &#13;&#10;    +' ID:'+SqlListaInterno.FieldByName('ID_INTERNO').AsString);  &#13;&#10;    SqlListaInterno.Next;&#13;&#10;  end;&#13;&#10;    ComboBox1.setFocus;&#13;&#10;    DataInicial.Date := now-30  ;&#13;&#10;    DataFinal.Date := now;        &#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnOkOnClick(Sender: TfrxComponent);&#13;&#10;var contador: integer;                                                  &#13;&#10;begin&#13;&#10;       ComboBox1.text := uppercase(ComboBox1.text);&#13;&#10;end;    &#13;&#10;                                              &#13;&#10;&#13;&#10;procedure DialogPage1OnCloseQuery(Sender: TfrxComponent; var CanClose: Boolean);&#13;&#10;var contador : integer;                                                          &#13;&#10;begin&#13;&#10;       contador := 0;                                         &#13;&#10;       SqlAgendamento.open;&#13;&#10;       SqlAgendamento.first;                                 &#13;&#10;       while not SqlAgendamento.EOF do&#13;&#10;       begin                                                      &#13;&#10;               contador := contador + 1;&#13;&#10;               SqlAgendamento.next;                               &#13;&#10;       end;               &#13;&#10;       SqlAgendamento.first;&#13;&#10;&#13;&#10;       if contador = 0 then&#13;&#10;       begin                   &#13;&#10;               memo10.visible := true;                                                                                &#13;&#10;       end;  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;end." PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C3600000020446174615365743D2273716C6167656E64616D656E746F2220446174615365744E616D653D2273716C6167656E64616D656E746F2200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3800000020446174615365743D2273716C4C69737461696E7465726E6F2220446174615365744E616D653D2273716C4C69737461696E7465726E6F220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C39000000204E616D653D22474C4F42414C5F49444147454E44415F4154454E44494D454E544F222056616C75653D2227323032362C20323032362C272200010C19000000204E616D653D2249445F5550222056616C75653D223130362200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C65667403B4000470546F700224"/>
    <TfrxDBXQuery Name="sqlagendamento" UserName="sqlagendamento" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT &#13;&#10;    INTERNO.NOME_INTERNO,&#13;&#10;    INTERNO.RGI,&#13;&#10;    vinc_falta_disciplinar.data_incidencia,&#13;&#10;    VINC_FALTA_DISCIPLINAR.obs,&#13;&#10;    VINC_FALTA_DISCIPLINAR.numero_pdi,&#13;&#10;    VINC_FALTA_DISCIPLINAR.data_resultado,&#13;&#10;    FALTA_DISCIPLINAR.falta_disciplinar,&#13;&#10;    FALTA_DISCIPLINAR.tipofalta,&#13;&#10;    vinc_falta_disciplinar.DATA_INCIDENCIA            &#13;&#10;FROM INTERNO&#13;&#10;   INNER JOIN vinc_falta_disciplinar ON (INTERNO.id_interno=vinc_falta_disciplinar.id_interno)&#13;&#10;   INNER JOIN FALTA_DISCIPLINAR ON (VINC_FALTA_DISCIPLINAR.id_falta_disciplinar=FALTA_DISCIPLINAR.id_falta_disciplinar)&#13;&#10;WHERE INTERNO.ST = 'A'              &#13;&#10;AND INTERNO.ID_UP = :ID_UP&#13;&#10;AND vinc_falta_disciplinar.DATA_INCIDENCIA BETWEEN :data and :data1&#13;&#10;AND coalesce(vinc_falta_disciplinar.status,'')=''&#13;&#10;AND FALTA_DISCIPLINAR.tipofalta like '%'|| :falta ||'%'                                                    &#13;&#10;AND ( (interno.NOME_INTERNO||' ('||interno.RGI||')'||' ID:'||interno.id_interno like '%'|| :nome_interno || '%') )&#13;&#10;  &#13;&#10;Order by Interno.Nome_Interno, vinc_falta_disciplinar.data_incidencia" Database="database" PropData="05704C65667403B4000470546F7002640A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3C000000204E616D653D2264617461222044617461547970653D22667444617465222045787072657373696F6E3D2244617461496E696369616C2E646174652200010C3B000000204E616D653D226461746131222044617461547970653D22667444617465222045787072657373696F6E3D224461746146696E616C2E646174652200010C3D000000204E616D653D2266616C7461222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F626F78322E746578742200010C44000000204E616D653D226E6F6D655F696E7465726E6F222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F626F78312E74657874220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;left join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C6566740314010470546F7002240A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlListainterno" UserName="sqlListainterno" CloseDataSource="True" FieldAliases.Text="" SQL.Text="    select&#13;&#10;i.nome_interno,&#13;&#10;i.RGI,                            &#13;&#10;i.id_interno                          &#13;&#10;from interno i    &#13;&#10;where I.ID_UP = :ID_UP&#13;&#10;and coalesce(i.nome_interno,'')&#60;&#62;''&#13;&#10;order by i.nome_interno  " Database="database" PropData="05704C6566740314010470546F7002640A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" Columns="1" ColumnWidth="211,9" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="139,84261" Left="0" ParentFont="False" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo2" Left="3,77953" Top="14,11812" Width="706,77211" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxPictureView Name="Picture2" Left="600,94527" Top="7,55906" Width="109,60629921" Height="105,82677165" FileLink="..\logo\direita.jpg"/>
      <TfrxPictureView Name="Picture1" Left="15,11811024" Top="7,55905512" Width="109,60629921" Height="105,82677165" FileLink="..\logo\esquerda.jpg"/>
      <TfrxMemoView Name="Memo11" Left="3,77953" Top="117,16543" Width="714,33117" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="FALTAS DISCIPLINARES POR PERÃODO"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" Height="18,89765" Left="0" Top="374,17347" Width="718,1107">
      <TfrxMemoView Name="Memo19" Left="11,33859" Top="18,89765" Width="718,1107" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" Height="52,91342" Left="0" Top="219,21274" Width="718,1107" Condition="sqlagendamento.&#34;NOME_INTERNO&#34;">
      <TfrxMemoView Name="sqlagendamentoNOME_INTERNO" Left="0" Top="11,33859" Width="718,11045591" Height="22,67718" StretchMode="smActualHeight" DataSet="sqlagendamento" DataSetName="sqlagendamento" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Nome do Interno - [sqlagendamento.&#34;NOME_INTERNO&#34;] - [sqlagendamento.&#34;RGI&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="75,5906" Top="34,01577" Width="75,59035591" Height="18,89765" StretchMode="smActualHeight" DataSet="sqlagendamento" DataSetName="sqlagendamento" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="PDI"/>
      <TfrxMemoView Name="Memo12" Left="151,1812" Top="34,01577" Width="336,37792591" Height="18,89765" StretchMode="smActualHeight" DataSet="frxDBDataset1" DataSetName="frxDBDataset1" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="FALTA DISCIPLINAR"/>
      <TfrxMemoView Name="Memo3" Left="0" Top="34,01577" Width="75,59035591" Height="18,89765" StretchMode="smActualHeight" DataSet="sqlagendamento" DataSetName="sqlagendamento" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="DATA"/>
      <TfrxMemoView Name="Memo7" Left="487,55937" Top="34,01577" Width="75,59035591" Height="18,89765" StretchMode="smActualHeight" DataSet="frxDBDataset1" DataSetName="frxDBDataset1" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="TIPO"/>
      <TfrxMemoView Name="Memo9" Left="563,14997" Top="34,01577" Width="154,96048591" Height="18,89765" StretchMode="smActualHeight" DataSet="frxDBDataset1" DataSetName="frxDBDataset1" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="OSERVAÃ‡Ã•ES"/>
    </TfrxGroupHeader>
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="18,89765" Left="0" ParentFont="False" Top="294,80334" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="sqlagendamento" DataSetName="sqlagendamento" RowCount="0" Stretched="True">
      <TfrxMemoView Name="sqlagendamentoTIPOFALTA" Left="487,55937" Top="0" Width="75,5906" Height="18,89765" StretchMode="smMaxHeight" DataField="TIPOFALTA" DataSet="sqlagendamento" DataSetName="sqlagendamento" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[sqlagendamento.&#34;TIPOFALTA&#34;]"/>
      <TfrxMemoView Name="sqlagendamentoOBS" Left="563,14997" Top="0" Width="154,96060795" Height="18,89765" StretchMode="smMaxHeight" DataSet="sqlagendamento" DataSetName="sqlagendamento" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[sqlagendamento.&#34;obs&#34;]"/>
      <TfrxMemoView Name="Memo1" Left="0" Top="0" Width="75,59035591" Height="18,89765" StretchMode="smMaxHeight" DataSet="sqlagendamento" DataSetName="sqlagendamento" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[sqlagendamento.&#34;data_incidencia&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="75,5906" Top="0" Width="75,59035591" Height="18,89765" StretchMode="smMaxHeight" DataSet="sqlagendamento" DataSetName="sqlagendamento" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[sqlagendamento.&#34;numero_pdi&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="151,1812" Top="0" Width="336,37792591" Height="18,89765" StretchMode="smMaxHeight" DataSet="sqlagendamento" DataSetName="sqlagendamento" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[sqlagendamento.&#34;falta_disciplinar&#34;]"/>
    </TfrxMasterData>
    <TfrxMemoView Name="Memo10" Left="0" Top="170,07885" Width="718,1107" Height="18,89765" Visible="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="255" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="NÃƒO HÃ REGISTRO DE FALTA PARA ESTE INTERNO NO PERÃODO ESPECIFICADO."/>
    <TfrxMemoView Name="Memo6" Left="245,66945" Top="-144,62214" Width="714,33117" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="194" Left="265" Top="150" Width="567" OnCloseQuery="DialogPage1OnCloseQuery" OnShow="DialogPage1OnShow">
    <TfrxDateEditControl Name="DataInicial" Left="8" Top="124" Width="145" Height="21" Color="-16777211" Date="41057,4578184259" Time="41057,4578184259"/>
    <TfrxLabelControl Name="Label1" Left="8" Top="92" Width="145" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Caption="Escolha o período:" Color="13948117"/>
    <TfrxLabelControl Name="Label2" Left="190" Top="128" Width="9" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" ParentFont="False" Caption="a" Color="13948117"/>
    <TfrxDateEditControl Name="DataFinal" Left="236" Top="124" Width="145" Height="21" Color="-16777211" Date="41273,4589299653" Time="41273,4589299653"/>
    <TfrxButtonControl Name="btnOk" Left="456" Top="124" Width="75" Height="25" Caption="OK" Default="True" ModalResult="1" OnClick="btnOkOnClick"/>
    <TfrxComboBoxControl Name="Combobox1" Left="8" Top="24" Width="377" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1"/>
    <TfrxLabelControl Name="Label3" Left="8" Top="4" Width="211" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Caption="Escolha o nome do interno:" Color="13948117"/>
    <TfrxComboBoxControl Name="ComboBox2" Left="392" Top="24" Width="145" Height="21" Color="-16777211" Items.Text="GRAVE&#13;&#10;MÉDIA&#13;&#10;LEVE" ItemIndex="-1"/>
    <TfrxLabelControl Name="Label4" Left="396" Top="4" Width="37" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Caption="Falta" Color="13948117"/>
    <TfrxLabelControl Name="Label5" Left="8" Top="56" Width="430" Height="16" Font.Charset="1" Font.Color="255" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Caption="Deixe em branco para trazer todos os internos com falta no período" Color="13948117"/>
  </TfrxDialogPage>
</TfrxReport>
