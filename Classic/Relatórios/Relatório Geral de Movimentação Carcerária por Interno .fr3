<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41177,4323556366" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;                                                            &#13;&#10;// memo11.text :='RELA츒 DE MUDAN큐S DE CELA - PER펦DO   '+ datetostr(dateedit2.date)+''+'   a   '+''+datetostr(dateedit1.date);&#13;&#10;// memo3.text := 'Bras巖ia-DF, '+ datetostr(dateedit1.date);&#13;&#10;end;&#13;&#10;  &#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  
Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exename)+'..\config\dbxconnections.ini');&#13;&#10;  SqlListaInterno.Open;&#13;&#10;  while not SqlListaInterno.EOF do&#13;&#10;  begin&#13;&#10;    ComboBox1.Items.Add(SqlListaInterno.FieldByName('NOME_INTERNO').AsString&#13;&#10;    +' ('+SqlListaInterno.FieldByName('RGI').AsString+')');  &#13;&#10;    SqlListaInterno.Next;&#13;&#10;  end;&#13;&#10;    ComboBox1.setFocus;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;                                               &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DateEdit2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3A00000020446174615365743D2273716C5472616E73666572656E6369612220446174615365744E616D653D2273716C5472616E73666572656E6369612200010C3800000020446174615365743D2273716C556E696461646550656E616C2220446174615365744E616D653D2273716C556E696461646550656E616C2200010C2E00000020446174615365743D2253514C44495245544F522220446174615365744E616D653D2253514C44495245544F522200010C3800000020446174615365743D2273716C4C69737461696E7465726E6F2220446174615365744E616D653D2273716C4C69737461696E7465726E6F220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C17000000204E616D653D22474C4F42414C5F4A555249444943412200010C19000000204E616D653D22474C4F42414C5F4449534349504C494E412200010C13000000204E616D653D22444154415F494E4943494F2200010C19000000204E616D653D2249445F5550222056616C75653D223130372200010C34000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D22274D494E495354C952494F204441204A55535449C741272200010C49000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227444550415254414D454E544F2050454E4954454E4349C152494F204E4143494F4E414C272200010C4D000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D222744495245544F52494120444F2053495354454D412050454E4954454E4349C152494F204645444552414C27220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="Database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C656674039C000470546F70021C"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="Database" PropData="05704C65667403DC000470546F70021C0A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlTransferencia" UserName="sqlTransferencia" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT&#13;&#10; i.rgi, i.nome_interno, i.pai, i.mae, i.vulgo,                                                                               &#13;&#10; hi.idhistorico_interno, hi.data_hora, hi.descricao, hi.motivo_saida, hi.status, hi.tipo_historico&#13;&#10;&#13;&#10;from interno i&#13;&#10;inner join historico_interno hi on (i.id_interno = hi.idinterno)&#13;&#10;                                             &#13;&#10;where ( (i.nome_interno||' ('||i.RGI||')' LIKE '%'|| :NOMEINTERNO || '%' ) )&#13;&#10;order by hi.idhistorico_interno, hi.data_hora                                               &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;                                                   " Database="Database" PropData="05704C6566740328010470546F70021C0A506172616D657465727301010C4F000000204E616D653D224E4F4D45494E5445524E4F222044617461547970653D226674537472696E67222045787072657373696F6E3D2275707065726361736528436F6D626F626F78312E74657874293B220000"/>
    <TfrxDBXQuery Name="sqlUnidadePenal" UserName="sqlUnidadePenal" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select nome_up from unidade_penal&#13;&#10;where id_up = :id_up  " Database="Database" PropData="05704C65667402440470546F70021C0A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SQLDIRETOR" UserName="SQLDIRETOR" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select f.nome_funcionario, u.nome_up, f.funcao, u.sigla from funcionario f&#13;&#10;inner join unidade_penal u on (u.id_up=f.id_up)&#13;&#10;where f.id_up = :id_up and f.funcao = 'DIRETOR'  " Database="Database" PropData="05704C65667403A0000470546F7002740A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlListainterno" UserName="sqlListainterno" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10;i.nome_interno,&#13;&#10;i.RGI,                            &#13;&#10;i.id_interno                          &#13;&#10;from interno i    &#13;&#10;where I.ID_UP = :ID_UP&#13;&#10;and coalesce(i.nome_interno,'')&#60;&#62;''&#13;&#10;order by i.nome_interno  " Database="Database" PropData="05704C6566740308010470546F7002700A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="211,9" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="251,78757" Left="0" ParentFont="False" Top="18,89765" Width="680,3154">
      <TfrxMemoView Name="Memo2" Left="-11,33859" Top="86,92919" Width="718,1107" Height="45,35436" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxMemoView Name="Memo11" Left="3,77953" Top="123,72449" Width="997,79592" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo3" Left="65,55906" Top="133,84261" Width="514,01608" Height="34,01577" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-21" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Relat칩rio de Movimenta칞칚o Carcer치ria do Interno"/>
      <TfrxMemoView Name="Memo6" Left="4,47248" Top="189,65368" Width="672,75634" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="4" ParentFont="False" Text="Prontu치rio: [SqlTransferencia.&#34;RGI&#34;] - Interno: [SqlTransferencia.&#34;NOME_INTERNO&#34;]  - Vulgo: [SqlTransferencia.&#34;VULGO&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="4,55906" Top="211,33086" Width="672,75634" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="Nome do Pai: [SqlTransferencia.&#34;PAI&#34;] &#13;&#10;Nome da M칚e: [SqlTransferencia.&#34;MAE&#34;] "/>
    </TfrxReportTitle>
    <TfrxPictureView Name="Picture4" Left="8,55906" Top="9,67717512" Width="109,60629921" Height="105,82677165" FileLink="..\logo\esquerda.jpg"/>
    <TfrxMemoView Name="Memo1" Left="-3,77953" Top="15,11812" Width="718,1107" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
    <TfrxPictureView Name="Picture3" Left="560,37044976" Top="11,11812" Width="109,60629921" Height="105,82677165" FileLink="..\logo\direita.jpg"/>
    <TfrxPageFooter Name="PageFooter1" Height="22,67718" Left="0" Top="566,9295" Width="680,3154">
      <TfrxMemoView Name="Memo19" Left="172,07885" Top="8,13388999999995" Width="502,67749" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxFooter Name="Footer1" Height="98,74799" Left="0" Top="408,18924" Width="680,3154">
      <TfrxMemoView Name="SQLDIRETORNOME_FUNCIONARIO" Left="25,7953" Top="37,7953" Width="627,40198" Height="18,89765" DataField="NOME_FUNCIONARIO" DataSet="SQLDIRETOR" DataSetName="SQLDIRETOR" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[SQLDIRETOR.&#34;NOME_FUNCIONARIO&#34;]"/>
      <TfrxMemoView Name="SQLDIRETORFUNCAO" Left="25,7953" Top="54,91342" Width="627,40198" Height="18,89765" DataSet="SQLDIRETOR" DataSetName="SQLDIRETOR" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[SQLDIRETOR.&#34;FUNCAO&#34;] - [SQLDIRETOR.&#34;SIGLA&#34;]"/>
      <TfrxMemoView Name="Memo30" Left="25,7953" Top="79,85034" Width="627,40198" Height="18,89765" DataSet="SQLDIRETOR" DataSetName="SQLDIRETOR" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="dd 'de' mmmm 'de' yyyy'.'" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;CIDADE&#34;], [Date]"/>
      <TfrxMemoView Name="Memo5" Left="204,09462" Top="18,89765" Width="272,12616" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="__________________________________________"/>
    </TfrxFooter>
    <TfrxMasterData Name="MasterData1" Height="52,91342" Left="0" Top="332,59864" Width="680,3154" ColumnWidth="0" ColumnGap="0" DataSet="sqlTransferencia" DataSetName="sqlTransferencia" RowCount="0">
      <TfrxMemoView Name="Memo9" Left="3,11812" Top="2" Width="672,75634" Height="49,13389" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" HAlign="haBlock" ParentFont="False" Text="Data: [SqlTransferencia.&#34;DATA_HORA&#34;] - [SqlTransferencia.&#34;DESCRICAO&#34;] - Motivo: [SqlTransferencia.&#34;MOTIVO_SAIDA&#34;]"/>
    </TfrxMasterData>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="162" Left="265" Top="179" Width="414" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="btnOk" Left="120" Top="64" Width="143" Height="53" Caption="OK" Default="True" ModalResult="1" OnClick="btnOkOnClick"/>
    <TfrxComboBoxControl Name="Combobox1" Left="8" Top="32" Width="377" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnClick="Combobox1OnClick"/>
    <TfrxLabelControl Name="Label4" Left="8" Top="12" Width="211" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Caption="Escolha o nome do interno:" Color="13948117"/>
  </TfrxDialogPage>
</TfrxReport>
