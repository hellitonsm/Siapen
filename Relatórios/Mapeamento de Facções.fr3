<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41151,707705706" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  
Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exename)+'..\config\dbxconnections.ini');  &#13;&#10;  SqlPavilhao.Open;&#13;&#10;  while not SqlPavilhao.EOF do&#13;&#10;  begin&#13;&#10;    ComboBox1.Items.Add(SqlPavilhao.FieldByName('PAVILHAO').AsString);&#13;&#10;    SqlPavilhao.Next;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;  &#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  &#13;&#10;  memo7.color := clWhite;&#13;&#10;    &#13;&#10;  if Sqlconfere.FieldByName('COR').AsString &#60;&#62; '' then&#13;&#10;  begin&#13;&#10;     memo7.Color := strToInt('$' + Sqlconfere.FieldByName('COR').AsString);                                                                                                &#13;&#10;  end;               &#13;&#10;     &#13;&#10;end;&#13;&#10;  &#13;&#10;begin&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2E00000020446174615365743D2253716C636F6E666572652220446174615365744E616D653D2253716C636F6E666572652200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3000000020446174615365743D2253716C506176696C68616F2220446174615365744E616D653D2253716C506176696C68616F220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C16000000204E616D653D22474C4F42414C5F434F4E464552452200010C19000000204E616D653D2249445F5550222056616C75653D223130312200010C34000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D22274D494E495354C952494F204441204A55535449C741272200010C49000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227444550415254414D454E544F2050454E4954454E4349C152494F204E4143494F4E414C272200010C4B000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D222744495245544F52494120444F2053495354454D412050454E4954454E4349C152494F20444F20444627220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="Database" ConnectionName="IBConnection" DriverName="Interbase" GetDriverFunc="getSQLDriverINTERBASE" LibraryName="dbexpint.dll" LoginPrompt="False" Params.Text="DriverName=Interbase&#13;&#10;Database=database.gdb&#13;&#10;RoleName=RoleName&#13;&#10;User_Name=sysdba&#13;&#10;Password=masterkey&#13;&#10;ServerCharSet=&#13;&#10;SQLDialect=1&#13;&#10;ErrorResourceFile=&#13;&#10;LocaleCode=0000&#13;&#10;BlobSize=-1&#13;&#10;CommitRetain=False&#13;&#10;WaitOnLocks=True&#13;&#10;Interbase TransIsolation=ReadCommited&#13;&#10;Trim Char=False" VendorLib="gds32.dll" PropData="05704C65667403E4000470546F700230"/>
    <TfrxDBXQuery Name="Sqlconfere" UserName="Sqlconfere" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT&#13;&#10;    CELA.CELA,&#13;&#10;    INTERNO.NOME_INTERNO,&#13;&#10;    INTERNO.FOTO,&#13;&#10;    INTERNO.UF,&#13;&#10;    INTERNO.em_transito,&#13;&#10;    PAVILHAO.PAVILHAO,&#13;&#10;    GALERIA.GALERIA,&#13;&#10;    CELA.CELA,&#13;&#10;    SOLARIO.SOLARIO,&#13;&#10;    INTERNO.faccao,&#13;&#10;    interno.sigla,                                  &#13;&#10;    interno.cor,                              &#13;&#10;    (SELECT COALESCE(INTERNO.NUMERO_ROUPA,'') AS numero_roupa&#13;&#10;     FROM INTERNO&#13;&#10;     WHERE INTERNO.ST = 'A'&#13;&#10;     AND COALESCE(INTERNO.EM_TRANSITO,'N') = 'N'&#13;&#10;     AND INTERNO.idcela = CELA.id_cela),&#13;&#10;&#13;&#10;    COALESCE((SELECT COUNT(*)&#13;&#10;              FROM INTERNO&#13;&#10;              WHERE INTERNO.ST = 'A'&#13;&#10;              AND COALESCE(INTERNO.EM_TRANSITO,'N') = 'N'&#13;&#10;              AND INTERNO.idcela = CELA.id_cela), 0) AS TOTAL_PISO&#13;&#10;&#13;&#10;FROM CELA&#13;&#10;   INNER JOIN SOLARIO ON (CELA.idsolario = SOLARIO.id_solario)&#13;&#10;   INNER JOIN GALERIA ON (solario.idgaleria = GALERIA.ID_GALERIA)&#13;&#10;   INNER JOIN PAVILHAO ON (galeria.idpavilhao = PAVILHAO.ID_PAVILHAO)&#13;&#10;   LEFT JOIN (SELECT INTERNO.NOME_INTERNO, INTERNO.IDCELA, INTERNO.FOTO,&#13;&#10;                cidade.UF, condicao_interno.descricao, COALESCE(FACCAO.faccao,'') AS FACCAO, COALESCE(faccao.cor,'') AS COR, COALESCE(faccao.sigla,'') AS SIGLA,&#13;&#10;                IIF(COALESCE(INTERNO.EM_TRANSITO,0) = 'S',1,IIF(COALESCE(INTERNO.EM_TRANSITO,0) = 'N',0,0)) AS EM_TRANSITO&#13;&#10;              FROM INTERNO&#13;&#10;              LEFT JOIN FACCAO ON (FACCAO.ID_FACCAO = INTERNO.ID_FACCAO) &#13;&#10;              LEFT JOIN CONDICAO_INTERNO ON (condicao_interno.IDCONDICAO_INTERNO = INTERNO.IDCONDICAO_INTERNO)&#13;&#10;              LEFT JOIN CIDADE ON (CIDADE.ID_CIDADE = INTERNO.IDCIDADE)&#13;&#10;              WHERE INTERNO.ST = 'A') AS INTERNO ON (INTERNO.IDCELA = CELA.ID_CELA)&#13;&#10;              &#13;&#10;WHERE pavilhao.PAVILHAO like :PAVILHAO || '%' &#13;&#10;AND PAVILHAO.ID_UP=:ID_UP&#13;&#10;&#13;&#10;ORDER BY pavilhao.PAVILHAO desc, CELA.CELA                                                                         " Database="Database" PropData="05704C6566740348010470546F7002300A506172616D657465727301010C40000000204E616D653D22504156494C48414F222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F426F78312E546578742200010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP&#13;&#10;  " Database="Database" PropData="05704C656674023C0470546F7002300A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlPavilhao" UserName="SqlPavilhao" CloseDataSource="False" FieldAliases.Text="" SQL.Text="SELECT pavilhao, id_pavilhao                                                              &#13;&#10;from pavilhao              &#13;&#10;WHERE ID_UP = :ID_UP&#13;&#10;  " Database="Database" PropData="05704C656674038C000470546F7002300A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="5" RightMargin="5" TopMargin="10" BottomMargin="10" Columns="1" ColumnWidth="267" ColumnPositions.Text="0" Duplex="dmSimplex" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="128,50401024" Left="0" ParentFont="False" Top="234,33086" Width="1084,72511" OnBeforePrint="MasterData1OnBeforePrint" Columns="13" ColumnWidth="83,5275590551181" ColumnGap="0" DataSet="Sqlconfere" DataSetName="Sqlconfere" RowCount="0">
      <TfrxMemoView Name="Memo7" Left="0" Top="97,51181102" Width="83,14961118" Height="30,23623024" DataSet="Sqlconfere" DataSetName="Sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Frame.Width="1,5" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Sqlconfere.&#34;NOME_INTERNO&#34;] / [Sqlconfere.&#34;UF&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="0" Top="1" Width="83,14966" Height="18,89765" DataSet="Sqlconfere" DataSetName="Sqlconfere" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="00" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Frame.Width="1,5" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Sqlconfere.&#34;CELA&#34;]"/>
      <TfrxPictureView Name="Picture2" Left="0,08658" Top="17,11812" Width="83,14966" Height="79,37013" DataField="FOTO" DataSet="Sqlconfere" DataSetName="Sqlconfere" Frame.Typ="15" Frame.Width="1,5"/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader1" Height="0" Left="0" Top="151,1812" Width="1084,72511" Condition="Sqlconfere.&#34;PAVILHAO&#34;" StartNewPage="True"/>
    <TfrxGroupHeader Name="GroupHeader2" Height="0" Left="0" Top="173,85838" Width="1084,72511" Condition="Sqlconfere.&#34;GALERIA&#34;"/>
    <TfrxGroupHeader Name="GroupHeader3" Height="15,11812" Left="0" Top="196,53556" Width="1084,72511" Condition="Sqlconfere.&#34;SOLARIO&#34;">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="377,953" Height="15,11812" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[sqlconfere.&#34;solario&#34;] [sqlconfere.&#34;galeria&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter1" Height="11,33859" Left="0" Top="385,51206" Width="1084,72511">
      <TfrxMemoView Name="Memo4" Left="925,98485" Top="0" Width="158,74026" Height="11,33859" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Width="2" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="TOTAL DA ALA:  [SUM(&#60;SqlConfere.&#34;TOTAL_PISO&#34;&#62;,MasterData1,0)]"/>
    </TfrxGroupFooter>
    <TfrxGroupFooter Name="GroupFooter2" Height="0" Left="0" Top="419,52783" Width="1084,72511"/>
    <TfrxGroupFooter Name="GroupFooter3" Height="11,33859" Left="0" Top="442,20501" Width="1084,72511">
      <TfrxMemoView Name="Memo5" Left="755,906" Top="0" Width="143,62214" Height="11,33859" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Width="2" ParentFont="False" VAlign="vaCenter" Text="TOTAL DA VIVÃŠNCIA:  [SUM(&#60;SqlConfere.&#34;TOTAL_PISO&#34;&#62;,MasterData1,0)]"/>
      <TfrxMemoView Name="Memo9" Left="600,94469394" Top="0" Width="147,40167" Height="11,33859" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="TOTAL EM TRANSITO:  [SUM(&#60;SqlConfere.&#34;EM_TRANSITO&#34;&#62;,MasterData1,0)]"/>
      <TfrxMemoView Name="Memo11" Left="903,30767" Top="0" Width="181,41744" Height="11,33859" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Width="2" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="TOTAL GERAL DA VIVÃŠNCIA:  [SUM(&#60;SqlConfere.&#34;TOTAL_PISO&#34;&#62;,MasterData1,0) + SUM(&#60;SqlConfere.&#34;EM_TRANSITO&#34;&#62;,MasterData1,0)]"/>
    </TfrxGroupFooter>
    <TfrxPageFooter Name="PageFooter1" Height="11,33859" Left="0" Top="514,01608" Width="1084,72511">
      <TfrxMemoView Name="Memo8" Left="0" Top="0" Width="1084,72511" Height="11,33859" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxReportTitle Name="ReportTitle1" Height="71,81107" Left="0" Top="18,89765" Width="1084,72511">
      <TfrxMemoView Name="Memo3" Left="0" Top="52,91342" Width="1084,72511" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="MAPEAMENTO DE FACÃ‡Ã•ES NA [SqlConfere.&#34;PAVILHAO&#34;] EM [DATE]"/>
      <TfrxMemoView Name="Memo1" Left="0" Top="0" Width="1084,72511" Height="49,13389" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
    </TfrxReportTitle>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="114" Left="265" Top="150" Width="446" OnShow="DialogPage1OnShow">
    <TfrxComboBoxControl Name="ComboBox1" Left="40" Top="32" Width="217" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1"/>
    <TfrxButtonControl Name="Button1" Left="328" Top="28" Width="75" Height="25" Caption="OK" Default="True" ModalResult="1"/>
    <TfrxLabelControl Name="Label1" Left="40" Top="12" Width="106" Height="13" Caption="INFORME A VIVÊNCIA" Color="13948117"/>
  </TfrxDialogPage>
</TfrxReport>
