<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="44195,5067342708" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;       &#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbpavilhaoOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  &#13;&#10; Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');&#13;&#10;    &#13;&#10;  Label1.Caption := 'Escolha o '+&#60;GLOBAL_NIVEL_2&#62;;&#13;&#10;    &#13;&#10;  Sqlgaleria.Open;&#13;&#10;  while not Sqlgaleria.EOF do&#13;&#10;  begin&#13;&#10;    comboboxpavilhao.Items.Add(Sqlgaleria.FieldByName('galeria').AsString);&#13;&#10;    Sqlgaleria.Next;&#13;&#10;  end;&#13;&#10;&#13;&#10;  DateEdit1.date := now();                                                              &#13;&#10; comboboxpavilhao.setfocus;                                             &#13;&#10;      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure comboboxpavilhaoOnChange(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   ComboBox1.Items.Clear;                              &#13;&#10;   SqlAla.Close;                             &#13;&#10;   SqlAla.Open;    &#13;&#10;   while not SqlAla.EOF do&#13;&#10;   begin&#13;&#10;       Combobox1.Items.Add(SqlAla.FieldByName('solario').asString);&#13;&#10;       SqlAla.Next;                                     &#13;&#10;  end;  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2E00000020446174615365743D2273716C636F6E666572652220446174615365744E616D653D2273716C636F6E666572652200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C2E00000020446174615365743D2273716C67616C657269612220446174615365744E616D653D2273716C67616C657269612200010C2600000020446174615365743D2253716C416C612220446174615365744E616D653D2253716C416C61220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C4F000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445205345475552414EC741205055424C494341272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.dll" PropData="05704C65667403B4000470546F700224"/>
    <TfrxDBXQuery Name="sqlconfere" UserName="sqlconfere" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT &#13;&#10;    (SELECT p.NOMELIMPO FROM SEM_FUGA (INTERNO.nome_interno) p) as nome_interno,  &#13;&#10;    INTERNO.RGI,                              &#13;&#10;    INTERNO.DATA_ENTRADA,&#13;&#10;    PAVILHAO.PAVILHAO,&#13;&#10;    GALERIA.GALERIA,&#13;&#10;    CELA.CELA,&#13;&#10;    SOLARIO.SOLARIO&#13;&#10;FROM INTERNO&#13;&#10;   INNER JOIN PAVILHAO ON (INTERNO.IDPAVILHAO = PAVILHAO.ID_PAVILHAO)&#13;&#10;   INNER JOIN GALERIA ON (INTERNO.IDGALERIA = GALERIA.ID_GALERIA)&#13;&#10;   INNER JOIN CELA ON (INTERNO.IDCELA = CELA.ID_CELA)&#13;&#10;   INNER JOIN SOLARIO ON (INTERNO.IDSOLARIO = SOLARIO.ID_SOLARIO)&#13;&#10;WHERE INTERNO.ST = 'A' AND INTERNO.ID_UP = :ID_UP and GALERIA.GALERIA like '%'||(:GALERIA) and SOLARIO.SOLARIO like '%'||(:PAVILHAO)||'%'                                                                                                                                                                                           &#13;&#10;ORDER BY PAVILHAO.PAVILHAO, GALERIA.GALERIA, SOLARIO.SOLARIO, INTERNO.NOME_INTERNO, INTERNO.DATA_ENTRADA  " Database="database" PropData="05704C65667403B4000470546F7002640A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C46000000204E616D653D2247414C45524941222044617461547970653D226674537472696E67222045787072657373696F6E3D22636F6D626F626F78706176696C68616F2E746578742200010C40000000204E616D653D22504156494C48414F222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F626F78312E74657874220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;left join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C6566740314010470546F7002240A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlgaleria" UserName="sqlgaleria" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select g.galeria from galeria g&#13;&#10;inner join pavilhao p on (p.id_pavilhao=g.idpavilhao)&#13;&#10;where p.id_up = :id_up&#13;&#10;order by g.galeria  " Database="database" PropData="05704C6566740310010470546F7002680A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlAla" UserName="SqlAla" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select s.solario from solario s&#13;&#10;inner join galeria g on (g.id_galeria = s.idgaleria)    &#13;&#10;inner join pavilhao p on (p.id_pavilhao=g.idpavilhao)                                                                                                                   &#13;&#10;where p.id_up = :id_up and g.galeria = :GALERIA                                                            &#13;&#10;order by s.solario                         " Database="database" PropData="05704C65667403B5000470546F7003A4000A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C46000000204E616D653D2247414C45524941222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F626F78706176696C68616F2E74657874220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="5" RightMargin="5" TopMargin="5" BottomMargin="3" Columns="1" ColumnWidth="211,9" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageHeader Name="PageHeader1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="4" Height="49,13388024" Left="0" ParentFont="False" Top="18,89765" Width="1084,72511">
      <TfrxMemoView Name="Memo1" Left="0" Top="0" Width="1088,50464" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="RELATÃ“RIO DE VISITAS FAMILIARES NÂº [EDIT1.text] - [SQLConfere.&#34;GALERIA&#34;] [SQLConfere.&#34;SOLARIO&#34;] - [DateEdit1.date #ddd/mm/yyyy]"/>
      <TfrxMemoView Name="Memo2" Left="30,23624" Top="30,23624" Width="355,27582" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Recuperando"/>
      <TfrxMemoView Name="Memo3" Left="0" Top="30,23624" Width="30,23624" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo4" Left="385,51206" Top="30,23624" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="DATA"/>
      <TfrxMemoView Name="Memo5" Left="480,00031" Top="30,23624" Width="98,26778" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="CANAL"/>
      <TfrxMemoView Name="Memo6" Left="578,26809" Top="30,23624" Width="79,37013" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="TEMPO"/>
      <TfrxMemoView Name="Memo7" Left="657,63822" Top="30,23624" Width="147,40167" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="FONE"/>
      <TfrxMemoView Name="Memo8" Left="805,03989" Top="30,23624" Width="279,68522" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ASSINATURA"/>
    </TfrxPageHeader>
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="22,67718" Left="0" ParentFont="False" Top="128,50402" Width="1084,72511" ColumnWidth="0" ColumnGap="0" DataSet="sqlconfere" DataSetName="sqlconfere" RowCount="0" Stretched="True">
      <TfrxMemoView Name="sqlconfereNOME_INTERNO" Left="30,23621803" Top="0" Width="355,27582" Height="22,67718" StretchMode="smMaxHeight" DataSet="sqlconfere" DataSetName="sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[sqlconfere.&#34;NOME_INTERNO&#34;] - [sqlconfere.&#34;RGI&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="385,51206" Top="0" Width="94,48825" Height="22,67718" StretchMode="smMaxHeight" DataSet="sqlconfere" DataSetName="sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[DateEdit1.date #ddd/mm/yyyy]"/>
      <TfrxMemoView Name="Memo10" Left="480,00031" Top="0" Width="98,26778" Height="22,67718" StretchMode="smMaxHeight" DataSet="sqlconfere" DataSetName="sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="WHATSAPP"/>
      <TfrxMemoView Name="Memo11" Left="578,26809" Top="0" Width="79,37013" Height="22,67718" StretchMode="smMaxHeight" DataSet="sqlconfere" DataSetName="sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="05:00"/>
      <TfrxMemoView Name="Memo12" Left="657,63822" Top="0" Width="147,40167" Height="22,67718" StretchMode="smMaxHeight" DataSet="sqlconfere" DataSetName="sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo13" Left="805,03989" Top="0" Width="279,68522" Height="22,67718" StretchMode="smMaxHeight" DataSet="sqlconfere" DataSetName="sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo14" Left="0" Top="0" Width="30,23624" Height="22,67718" StretchMode="smMaxHeight" DataSet="sqlconfere" DataSetName="sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[line#]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" Height="18,89765" Left="0" Top="211,65368" Width="1084,72511">
      <TfrxMemoView Name="Memo19" Left="0" Top="0" Width="676,53587" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="280" Left="517" Top="163" Width="297" OnShow="DialogPage1OnShow">
    <TfrxLabelControl Name="Label1" Left="17" Top="64" Width="103" Height="13" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Escolha o Pavilhão" Color="13948117"/>
    <TfrxButtonControl Name="btnok" Left="106" Top="214" Width="75" Height="25" Caption="OK" Default="True" ModalResult="1"/>
    <TfrxComboBoxControl Name="comboboxpavilhao" Left="16" Top="84" Width="253" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnChange="comboboxpavilhaoOnChange"/>
    <TfrxLabelControl Name="Label2" Left="16" Top="110" Width="74" Height="13" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Escolha a Ala" Color="13948117" OnClick="Label2OnClick"/>
    <TfrxComboBoxControl Name="ComboBox1" Left="16" Top="127" Width="253" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1"/>
    <TfrxEditControl Name="Edit1" Left="16" Top="36" Width="249" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxLabelControl Name="Label3" Left="20" Top="16" Width="19" Height="13" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Nº:" Color="13948117"/>
    <TfrxDateEditControl Name="DateEdit1" Left="16" Top="172" Width="145" Height="21" Color="-16777211" Date="44194,5748416088" Time="44194,5748416088"/>
    <TfrxLabelControl Name="Label4" Left="16" Top="152" Width="83" Height="13" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Escolha a Data" Color="13948117" OnClick="Label2OnClick"/>
  </TfrxDialogPage>
</TfrxReport>
