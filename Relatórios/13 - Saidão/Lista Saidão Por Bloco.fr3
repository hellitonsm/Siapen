<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41183,6027247338" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure btnOkOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure txtBlocoOnChange(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;          &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');&#13;&#10;    &#13;&#10;  Label2.Caption := 'Escolha o '+&#60;GLOBAL_NIVEL_2&#62;;&#13;&#10;    &#13;&#10;  Sqlgaleria.Open;&#13;&#10;  while not Sqlgaleria.EOF do&#13;&#10;  begin&#13;&#10;    comboboxpavilhao.Items.Add(Sqlgaleria.FieldByName('galeria').AsString);&#13;&#10;    Sqlgaleria.Next;&#13;&#10;  end;&#13;&#10;&#13;&#10;       txtNumPortaria.setfocus;                          &#13;&#10;   &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2E00000020446174615365743D2273716C636F6E666572652220446174615365744E616D653D2273716C636F6E666572652200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C2E00000020446174615365743D2273716C67616C657269612220446174615365744E616D653D2273716C67616C65726961220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C1D000000204E616D653D22504F525441524941222056616C75653D22313031302200010C19000000204E616D653D2249445F5550222056616C75653D223130352200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="gds32.DLL" PropData="05704C65667403B4000470546F700224"/>
    <TfrxDBXQuery Name="sqlconfere" UserName="sqlconfere" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT &#13;&#10;    INTERNO.NOME_INTERNO,&#13;&#10;    INTERNO.RGI,&#13;&#10;    INTERNO.TIPOREGIME,&#13;&#10;    interno.regime_atual,                                                &#13;&#10;    unidade_penal.nome_up,&#13;&#10;    PAVILHAO.PAVILHAO,&#13;&#10;    GALERIA.GALERIA,&#13;&#10;    CELA.CELA,&#13;&#10;    SOLARIO.SOLARIO,&#13;&#10;    saidao.numero_portaria,&#13;&#10;    saidao.data_portaria,&#13;&#10;    saidao.data_saida,&#13;&#10;    saidao.data_retorno,&#13;&#10;    saidao.hora_saida,                &#13;&#10;    tipo_saidao.tipo_saidao,&#13;&#10;    vinc_saidao.status&#13;&#10;      &#13;&#10;FROM SAIDAO&#13;&#10;&#13;&#10;inner join vinc_saidao on (vinc_saidao.id_saidao = saidao.id_saidao)&#13;&#10;inner join interno on (interno.id_interno = vinc_saidao.id_interno)&#13;&#10;inner join tipo_saidao on (tipo_saidao.id_tipo_saidao=saidao.id_tipo_saidao)&#13;&#10;inner join  unidade_penal ON (interno.id_up=unidade_penal.id_up)&#13;&#10;inner JOIN PAVILHAO ON (INTERNO.IDPAVILHAO = PAVILHAO.ID_PAVILHAO)&#13;&#10;INNER JOIN GALERIA ON (INTERNO.IDGALERIA = GALERIA.ID_GALERIA)&#13;&#10;INNER JOIN CELA ON (INTERNO.IDCELA = CELA.ID_CELA)&#13;&#10;INNER JOIN SOLARIO ON (INTERNO.IDSOLARIO = SOLARIO.ID_SOLARIO)&#13;&#10;&#13;&#10;where saidao.id_up = :id_up &#13;&#10;and interno.id_up =:id_up&#13;&#10;and saidao.numero_portaria = :portaria&#13;&#10;and interno.st = 'A'&#13;&#10;and galeria.galeria like '%' || :pavilhao || '%'&#13;&#10;and vinc_saidao.status = 'ATIVO'                                                                                                               &#13;&#10;&#13;&#10;ORDER BY  GALERIA.GALERIA, SOLARIO.SOLARIO, CELA.CELA, INTERNO.NOME_INTERNO&#13;&#10;    " Database="database" PropData="05704C65667403B4000470546F7002640A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C45000000204E616D653D22706F727461726961222044617461547970653D226674537472696E67222045787072657373696F6E3D227478744E756D506F7274617269612E746578742200010C47000000204E616D653D22706176696C68616F222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F426F78706176696C68616F2E74657874220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;left join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C6566740314010470546F7002240A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlgaleria" UserName="sqlgaleria" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select g.galeria from galeria g&#13;&#10;inner join pavilhao p on (p.id_pavilhao=g.idpavilhao)&#13;&#10;where p.id_up = :id_up&#13;&#10;order by g.galeria  " Database="database" PropData="05704C6566740310010470546F7002680A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" Columns="1" ColumnWidth="206" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="120,94496" Left="0" ParentFont="False" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo4" Align="baClient" Left="0" Top="0" Width="718,1107" Height="120,94496" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="1" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo2" Left="49,13389" Top="14,11812" Width="680,3154" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="49,13389" Top="74,5906" Width="684,09493" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxPictureView Name="Picture2" Left="592,3154" Top="7,55906" Width="109,60629921" Height="105,82677165" FileLink="..\logo\direita.jpg"/>
      <TfrxPictureView Name="Picture1" Left="15,11811024" Top="7,55905512" Width="109,60629921" Height="105,82677165" FileLink="..\logo\esquerda.jpg"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="22,67718" Left="0" ParentFont="False" Top="400,63018" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="sqlconfere" DataSetName="sqlconfere" RowCount="0">
      <TfrxMemoView Name="sqlconfereNOME_INTERNO" Left="2,55906" Top="1,13385826771654" Width="90,70859795" Height="18,89765" DataSet="sqlconfere" DataSetName="sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlconfere.&#34;RGI&#34;]"/>
      <TfrxMemoView Name="sqlconfereSOLARIO" Left="356,27582" Top="1,13385827" Width="204,09449795" Height="18,89765" DataSet="sqlconfere" DataSetName="sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlconfere.&#34;galeria&#34;] - [sqlconfere.&#34;solario&#34;] - [sqlconfere.&#34;CELA&#34;]"/>
      <TfrxMemoView Name="sqlconfereTIPOREGIME" Left="566,81138" Top="1,13385826771654" Width="147,40154795" Height="18,89765" DataSet="sqlconfere" DataSetName="sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlconfere.&#34;REGIME_ATUAL&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="96,26778" Top="1,13385826771654" Width="257,00791795" Height="18,89765" DataSet="sqlconfere" DataSetName="sqlconfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlconfere.&#34;NOME_INTERNO&#34;]"/>
    </TfrxMasterData>
    <TfrxReportSummary Name="ReportSummary1" Height="34,01577" Left="0" Top="483,77984" Width="718,1107">
      <TfrxMemoView Name="Memo5" Left="9,10235" Top="13,55906" Width="393,07112" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Total geral de internos: [COUNT(MasterData1)]"/>
    </TfrxReportSummary>
    <TfrxPageFooter Name="PageFooter1" Height="26,45671" Left="0" Top="540,47279" Width="718,1107">
      <TfrxMemoView Name="Memo19" Left="0" Top="7,55906" Width="714,33117" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxPageHeader Name="PageHeader1" Height="45,35436" Left="0" Top="162,51979" Width="718,1107">
      <TfrxMemoView Name="Memo3" Left="0,44094" Top="0" Width="718,1107" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="5" HAlign="haCenter" ParentFont="False" Text="Controle saidÃ£o do dia: [sqlconfere.&#34;DATA_SAIDA&#34;]. Hora: [sqlconfere.&#34;hora_saida&#34;]. Tipo de saidÃ£o: [sqlconfere.&#34;TIPO_SAIDAO&#34;]"/>
    </TfrxPageHeader>
    <TfrxGroupHeader Name="GroupHeader1" Height="56,69295" Left="0" Top="321,26005" Width="718,1107" Condition="sqlconfere.&#34;SOLARIO&#34;">
      <TfrxMemoView Name="Memo1" Left="3,77953" Top="33,45671" Width="86,92919" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="ProntuÃ¡rio  "/>
      <TfrxMemoView Name="Memo7" Left="363,51206" Top="33,45671" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Local. carc."/>
      <TfrxMemoView Name="Memo8" Left="573,26809" Top="33,45671" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Regime"/>
      <TfrxMemoView Name="Memo9" Left="102,04731" Top="33,45671" Width="86,92919" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Interno"/>
      <TfrxMemoView Name="Memo11" Left="3,77953" Top="5" Width="404,40971" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="5" ParentFont="False" Text="Ala: [Sqlconfere.&#34;SOLARIO&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="GroupHeader2" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="30,23623024" Left="0" ParentFont="False" Top="268,34663" Width="718,1107" Condition="sqlconfere.&#34;GALERIA&#34;">
      <TfrxMemoView Name="PresidioGALERIA" Left="3,77953" Top="11,33859" Width="712,4411548" Height="15,11811024" DataSet="frxDBDataset1" DataSetName="frxDBDataset1" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="12" ParentFont="False" Text="[GLOBAL_NIVEL_2]: [SqlConfere.&#34;GALERIA&#34;]"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Informe Portaria e Bloco" Height="229" Left="265" Top="150" Width="309" OnShow="DialogPage1OnShow">
    <TfrxEditControl Name="txtNumPortaria" Left="44" Top="43" Width="237" Height="25" Color="-16777211" MaxLength="0" PasswordChar="0" TabStop="False"/>
    <TfrxLabelControl Name="Label1" Left="12" Top="20" Width="93" Height="13" Caption="Número da Portaria" Color="13948117"/>
    <TfrxComboBoxControl Name="ComboBoxpavilhao" Left="44" Top="92" Width="237" Height="21" Color="-16777211" Items.Text="" TabStop="False" ItemIndex="-1"/>
    <TfrxLabelControl Name="Label2" Left="12" Top="74" Width="29" Height="13" Caption="Bloco:" Color="13948117"/>
    <TfrxButtonControl Name="btnOk" Left="206" Top="156" Width="75" Height="25" Caption="OK" Default="True" ModalResult="1" OnClick="btnOkOnClick"/>
    <TfrxLabelControl Name="Label4" Left="12" Top="124" Width="225" Height="13" Font.Charset="1" Font.Color="255" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" Caption="Deixar em branco para buscar todos os blocos." Color="13948117"/>
  </TfrxDialogPage>
</TfrxReport>
